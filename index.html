<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Динамика показателей по магазинам</title>
    
    <!-- React и ReactDOM через CDN -->
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Recharts для графиков -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.8.0/Recharts.min.js"></script>
    
    <!-- Babel для JSX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.5/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        const SalesDashboard = () => {
          // Встраиваем данные прямо в компонент
          const data = [
            {
              month: "сентябрь 2024",
              wildberries: {
                revenue: 5061499.6,
                cost: 2606218.37,
                expenses: 818363.28,
                profit: 1636917.95,
                margin: 0.4779906328120397
              },
              ozon: {
                revenue: 9478101.03,
                cost: 4793858.65,
                expenses: 3027975.14,
                profit: 1656267.24,
                margin: 0.21174922460222695
              }
            },
            {
              month: "октябрь 2024",
              wildberries: {
                revenue: 3631804.04,
                cost: 2606218.37,
                expenses: 818363.28,
                profit: 207222.39,
                margin: 0.060510278678856916
              },
              ozon: {
                revenue: 11106722.23,
                cost: 4793858.65,
                expenses: 3027975.14,
                profit: 3284888.44,
                margin: 0.4199639788050264
              }
            },
            {
              month: "ноябрь 2024",
              wildberries: {
                revenue: 4296754,
                cost: 2256487,
                expenses: 820414,
                profit: 1219853,
                margin: 0.3964550695651241
              },
              ozon: {
                revenue: 12948704,
                cost: 6436076,
                expenses: 4162147,
                profit: 2350481,
                margin: 0.22178067021235542
              }
            },
            {
              month: "Декабрь 2024",
              wildberries: {
                revenue: 13942410.58,
                cost: 9708836.37,
                expenses: 2828925,
                profit: 1404649.21,
                margin: 0.11203349374322961
              },
              ozon: {
                revenue: 13827524.64,
                cost: 7491593.3,
                expenses: 4021184,
                profit: 2314747.34,
                margin: 0.2010589868701795
              }
            },
            {
              month: "Яеварь 2025",
              wildberries: {
                revenue: 2196432.59,
                cost: 1078915.61,
                expenses: 475453,
                profit: 642063.98,
                margin: 0.41307060363242903
              },
              ozon: {
                revenue: 14399817.7,
                cost: 6937700.83,
                expenses: 4404780,
                profit: 3057336.87,
                margin: 0.26954745754681597
              }
            },
            {
              month: "февраль 2025",
              wildberries: {
                revenue: 4025213,
                cost: 2124256,
                expenses: 503020,
                profit: 1397937,
                margin: 0.5320860845986489
              },
              ozon: {
                revenue: 13388232,
                cost: 6903617,
                expenses: 3504031,
                profit: 2980584,
                margin: 0.28638401298737237
              }
            },
            {
              month: "март 2025",
              wildberries: {
                revenue: 6175693,
                cost: 3507219,
                expenses: 770128,
                profit: 1898346,
                margin: 0.4438138874400417
              },
              ozon: {
                revenue: 16858885,
                cost: 9297120,
                expenses: 3505049,
                profit: 4056716,
                margin: 0.31687724166115916
              }
            },
            {
              month: "Апрель 2025",
              wildberries: {
                revenue: 5674564.96,
                cost: 3422528.94,
                expenses: 1049231.95,
                profit: 1202804.07,
                margin: 0.2689777247906473
              },
              ozon: {
                revenue: 12986901.1,
                cost: 7117001.02,
                expenses: 2962843.3,
                profit: 2907056.78,
                margin: 0.2884029443026161
              }
            },
            {
              month: "июнь 2025",
              wildberries: {
                revenue: 6649356,
                cost: 3941421,
                expenses: 1380637,
                profit: 1327298,
                margin: 0.24939562853317268
              },
              ozon: {
                revenue: 12416880,
                cost: 7510481,
                expenses: 1965388,
                profit: 2941011,
                margin: 0.31036847385712063
              }
            },
            {
              month: "июль 2025",
              wildberries: {
                revenue: 3933461.14,
                cost: 1934417.68,
                expenses: 1595713.83,
                profit: 403329.63,
                margin: 0.11425342904576384
              },
              ozon: {
                revenue: 15245155.22,
                cost: 8831417.36,
                expenses: 3674050.1,
                profit: 2739687.76,
                margin: 0.21907919626060918
              }
            }
          ];

          // Форматирование чисел
          const formatCurrency = (value) => {
            if (value >= 1000000) {
              return `${(value / 1000000).toFixed(1)}М ₽`;
            }
            if (value >= 1000) {
              return `${(value / 1000).toFixed(0)}К ₽`;
            }
            return `${value.toFixed(0)} ₽`;
          };

          const formatPercent = (value) => {
            return `${(value * 100).toFixed(1)}%`;
          };

          // Подготовка данных для графиков
          const chartData = data.map(item => ({
            month: item.month,
            // Вайлдберриз
            wbRevenue: item.wildberries.revenue,
            wbCost: item.wildberries.cost,
            wbExpenses: item.wildberries.expenses,
            wbProfit: item.wildberries.profit,
            wbMargin: item.wildberries.margin,
            // Озон
            ozonRevenue: item.ozon.revenue,
            ozonCost: item.ozon.cost,
            ozonExpenses: item.ozon.expenses,
            ozonProfit: item.ozon.profit,
            ozonMargin: item.ozon.margin,
          }));

          // Кастомный тултип
          const CustomTooltip = ({ active, payload, label, isPercent = false }) => {
            if (active && payload && payload.length) {
              return React.createElement('div', {
                className: "bg-white p-4 border border-gray-300 rounded-lg shadow-lg"
              }, [
                React.createElement('p', {
                  key: 'label',
                  className: "font-semibold text-gray-800 mb-2"
                }, label),
                ...payload.map((entry, index) => 
                  React.createElement('p', {
                    key: index,
                    className: "text-sm",
                    style: { color: entry.color }
                  }, `${entry.name}: ${
                    isPercent 
                      ? formatPercent(entry.value)
                      : formatCurrency(entry.value)
                  }`)
                )
              ]);
            }
            return null;
          };

          return React.createElement('div', {
            className: "p-6 bg-gray-50 min-h-screen"
          }, 
            React.createElement('div', {
              className: "max-w-7xl mx-auto"
            }, [
              // Заголовок
              React.createElement('div', {
                key: 'header',
                className: "mb-8"
              }, [
                React.createElement('h1', {
                  key: 'title',
                  className: "text-3xl font-bold text-gray-900 mb-2"
                }, "Динамика показателей по магазинам"),
                React.createElement('p', {
                  key: 'subtitle',
                  className: "text-gray-600"
                }, `Тренды Вайлдберриз vs Интернет Решения ООО (Озон) • ${data[0]?.month} - ${data[data.length - 1]?.month}`)
              ]),

              // График 1: Стоимость продажи
              React.createElement('div', {
                key: 'chart1',
                className: "bg-white rounded-lg shadow-sm p-6 mb-6"
              }, [
                React.createElement('h2', {
                  key: 'chart1-title',
                  className: "text-xl font-semibold text-gray-900 mb-4"
                }, "📈 Стоимость продажи (RUB)"),
                React.createElement(ResponsiveContainer, {
                  key: 'chart1-container',
                  width: "100%",
                  height: 350
                }, 
                  React.createElement(LineChart, {
                    data: chartData
                  }, [
                    React.createElement(CartesianGrid, {
                      key: 'grid1',
                      strokeDasharray: "3 3",
                      stroke: "#f0f0f0"
                    }),
                    React.createElement(XAxis, {
                      key: 'xaxis1',
                      dataKey: "month",
                      angle: -45,
                      textAnchor: "end",
                      height: 80,
                      fontSize: 12
                    }),
                    React.createElement(YAxis, {
                      key: 'yaxis1',
                      tickFormatter: formatCurrency
                    }),
                    React.createElement(Tooltip, {
                      key: 'tooltip1',
                      content: React.createElement(CustomTooltip)
                    }),
                    React.createElement(Legend, { key: 'legend1' }),
                    React.createElement(Line, {
                      key: 'line1-wb',
                      type: "monotone",
                      dataKey: "wbRevenue",
                      stroke: "#dc2626",
                      strokeWidth: 3,
                      name: "Вайлдберриз",
                      dot: { fill: '#dc2626', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#dc2626', strokeWidth: 2, fill: '#fff' }
                    }),
                    React.createElement(Line, {
                      key: 'line1-ozon',
                      type: "monotone",
                      dataKey: "ozonRevenue",
                      stroke: "#7c3aed",
                      strokeWidth: 3,
                      name: "Интернет Решения ООО (Озон)",
                      dot: { fill: '#7c3aed', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#7c3aed', strokeWidth: 2, fill: '#fff' }
                    })
                  ])
                )
              ]),

              // График 2: Себестоимость  
              React.createElement('div', {
                key: 'chart2',
                className: "bg-white rounded-lg shadow-sm p-6 mb-6"
              }, [
                React.createElement('h2', {
                  key: 'chart2-title',
                  className: "text-xl font-semibold text-gray-900 mb-4"
                }, "💰 Себестоимость (RUB)"),
                React.createElement(ResponsiveContainer, {
                  key: 'chart2-container',
                  width: "100%",
                  height: 350
                }, 
                  React.createElement(LineChart, {
                    data: chartData
                  }, [
                    React.createElement(CartesianGrid, {
                      key: 'grid2',
                      strokeDasharray: "3 3",
                      stroke: "#f0f0f0"
                    }),
                    React.createElement(XAxis, {
                      key: 'xaxis2',
                      dataKey: "month",
                      angle: -45,
                      textAnchor: "end",
                      height: 80,
                      fontSize: 12
                    }),
                    React.createElement(YAxis, {
                      key: 'yaxis2',
                      tickFormatter: formatCurrency
                    }),
                    React.createElement(Tooltip, {
                      key: 'tooltip2',
                      content: React.createElement(CustomTooltip)
                    }),
                    React.createElement(Legend, { key: 'legend2' }),
                    React.createElement(Line, {
                      key: 'line2-wb',
                      type: "monotone",
                      dataKey: "wbCost",
                      stroke: "#dc2626",
                      strokeWidth: 3,
                      name: "Вайлдберриз",
                      dot: { fill: '#dc2626', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#dc2626', strokeWidth: 2, fill: '#fff' }
                    }),
                    React.createElement(Line, {
                      key: 'line2-ozon',
                      type: "monotone",
                      dataKey: "ozonCost",
                      stroke: "#7c3aed",
                      strokeWidth: 3,
                      name: "Интернет Решения ООО (Озон)",
                      dot: { fill: '#7c3aed', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#7c3aed', strokeWidth: 2, fill: '#fff' }
                    })
                  ])
                )
              ]),

              // График 3: Расходы МП
              React.createElement('div', {
                key: 'chart3',
                className: "bg-white rounded-lg shadow-sm p-6 mb-6"
              }, [
                React.createElement('h2', {
                  key: 'chart3-title',
                  className: "text-xl font-semibold text-gray-900 mb-4"
                }, "📊 Расходы МП (RUB)"),
                React.createElement(ResponsiveContainer, {
                  key: 'chart3-container',
                  width: "100%",
                  height: 350
                }, 
                  React.createElement(LineChart, {
                    data: chartData
                  }, [
                    React.createElement(CartesianGrid, {
                      key: 'grid3',
                      strokeDasharray: "3 3",
                      stroke: "#f0f0f0"
                    }),
                    React.createElement(XAxis, {
                      key: 'xaxis3',
                      dataKey: "month",
                      angle: -45,
                      textAnchor: "end",
                      height: 80,
                      fontSize: 12
                    }),
                    React.createElement(YAxis, {
                      key: 'yaxis3',
                      tickFormatter: formatCurrency
                    }),
                    React.createElement(Tooltip, {
                      key: 'tooltip3',
                      content: React.createElement(CustomTooltip)
                    }),
                    React.createElement(Legend, { key: 'legend3' }),
                    React.createElement(Line, {
                      key: 'line3-wb',
                      type: "monotone",
                      dataKey: "wbExpenses",
                      stroke: "#dc2626",
                      strokeWidth: 3,
                      name: "Вайлдберриз",
                      dot: { fill: '#dc2626', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#dc2626', strokeWidth: 2, fill: '#fff' }
                    }),
                    React.createElement(Line, {
                      key: 'line3-ozon',
                      type: "monotone",
                      dataKey: "ozonExpenses",
                      stroke: "#7c3aed",
                      strokeWidth: 3,
                      name: "Интернет Решения ООО (Озон)",
                      dot: { fill: '#7c3aed', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#7c3aed', strokeWidth: 2, fill: '#fff' }
                    })
                  ])
                )
              ]),

              // График 4: Валовая прибыль
              React.createElement('div', {
                key: 'chart4',
                className: "bg-white rounded-lg shadow-sm p-6 mb-6"
              }, [
                React.createElement('h2', {
                  key: 'chart4-title',
                  className: "text-xl font-semibold text-gray-900 mb-4"
                }, "💵 Валовая прибыль (RUB)"),
                React.createElement(ResponsiveContainer, {
                  key: 'chart4-container',
                  width: "100%",
                  height: 350
                }, 
                  React.createElement(LineChart, {
                    data: chartData
                  }, [
                    React.createElement(CartesianGrid, {
                      key: 'grid4',
                      strokeDasharray: "3 3",
                      stroke: "#f0f0f0"
                    }),
                    React.createElement(XAxis, {
                      key: 'xaxis4',
                      dataKey: "month",
                      angle: -45,
                      textAnchor: "end",
                      height: 80,
                      fontSize: 12
                    }),
                    React.createElement(YAxis, {
                      key: 'yaxis4',
                      tickFormatter: formatCurrency
                    }),
                    React.createElement(Tooltip, {
                      key: 'tooltip4',
                      content: React.createElement(CustomTooltip)
                    }),
                    React.createElement(Legend, { key: 'legend4' }),
                    React.createElement(Line, {
                      key: 'line4-wb',
                      type: "monotone",
                      dataKey: "wbProfit",
                      stroke: "#dc2626",
                      strokeWidth: 3,
                      name: "Вайлдберриз",
                      dot: { fill: '#dc2626', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#dc2626', strokeWidth: 2, fill: '#fff' }
                    }),
                    React.createElement(Line, {
                      key: 'line4-ozon',
                      type: "monotone",
                      dataKey: "ozonProfit",
                      stroke: "#7c3aed",
                      strokeWidth: 3,
                      name: "Интернет Решения ООО (Озон)",
                      dot: { fill: '#7c3aed', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#7c3aed', strokeWidth: 2, fill: '#fff' }
                    })
                  ])
                )
              ]),

              // График 5: Наценка
              React.createElement('div', {
                key: 'chart5',
                className: "bg-white rounded-lg shadow-sm p-6 mb-6"
              }, [
                React.createElement('h2', {
                  key: 'chart5-title',
                  className: "text-xl font-semibold text-gray-900 mb-4"
                }, "📋 Наценка (%)"),
                React.createElement(ResponsiveContainer, {
                  key: 'chart5-container',
                  width: "100%",
                  height: 350
                }, 
                  React.createElement(LineChart, {
                    data: chartData
                  }, [
                    React.createElement(CartesianGrid, {
                      key: 'grid5',
                      strokeDasharray: "3 3",
                      stroke: "#f0f0f0"
                    }),
                    React.createElement(XAxis, {
                      key: 'xaxis5',
                      dataKey: "month",
                      angle: -45,
                      textAnchor: "end",
                      height: 80,
                      fontSize: 12
                    }),
                    React.createElement(YAxis, {
                      key: 'yaxis5',
                      tickFormatter: formatPercent
                    }),
                    React.createElement(Tooltip, {
                      key: 'tooltip5',
                      content: React.createElement(CustomTooltip, { isPercent: true })
                    }),
                    React.createElement(Legend, { key: 'legend5' }),
                    React.createElement(Line, {
                      key: 'line5-wb',
                      type: "monotone",
                      dataKey: "wbMargin",
                      stroke: "#dc2626",
                      strokeWidth: 3,
                      name: "Вайлдберриз",
                      dot: { fill: '#dc2626', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#dc2626', strokeWidth: 2, fill: '#fff' }
                    }),
                    React.createElement(Line, {
                      key: 'line5-ozon',
                      type: "monotone",
                      dataKey: "ozonMargin",
                      stroke: "#7c3aed",
                      strokeWidth: 3,
                      name: "Интернет Решения ООО (Озон)",
                      dot: { fill: '#7c3aed', strokeWidth: 2, r: 5 },
                      activeDot: { r: 7, stroke: '#7c3aed', strokeWidth: 2, fill: '#fff' }
                    })
                  ])
                )
              ]),

              // Краткая сводка
              React.createElement('div', {
                key: 'summary',
                className: "bg-white rounded-lg shadow-sm p-6"
              }, [
                React.createElement('h2', {
                  key: 'summary-title',
                  className: "text-xl font-semibold text-gray-900 mb-4"
                }, "📋 Краткая сводка (июль 2025)"),
                React.createElement('div', {
                  key: 'summary-content',
                  className: "grid grid-cols-1 md:grid-cols-2 gap-6"
                }, [
                  React.createElement('div', {
                    key: 'wb-summary',
                    className: "border-l-4 border-red-500 pl-4"
                  }, [
                    React.createElement('h3', {
                      key: 'wb-title',
                      className: "font-semibold text-red-600 mb-2"
                    }, "Вайлдберриз"),
                    React.createElement('ul', {
                      key: 'wb-list',
                      className: "text-sm text-gray-600 space-y-1"
                    }, [
                      React.createElement('li', { key: 'wb-revenue' }, `• Выручка: ${formatCurrency(data[data.length-1]?.wildberries.revenue || 0)}`),
                      React.createElement('li', { key: 'wb-profit' }, `• Валовая прибыль: ${formatCurrency(data[data.length-1]?.wildberries.profit || 0)}`),
                      React.createElement('li', { key: 'wb-margin' }, `• Наценка: ${formatPercent(data[data.length-1]?.wildberries.margin || 0)}`)
                    ])
                  ]),
                  React.createElement('div', {
                    key: 'ozon-summary',
                    className: "border-l-4 border-purple-500 pl-4"
                  }, [
                    React.createElement('h3', {
                      key: 'ozon-title',
                      className: "font-semibold text-purple-600 mb-2"
                    }, "Интернет Решения ООО (Озон)"),
                    React.createElement('ul', {
                      key: 'ozon-list',
                      className: "text-sm text-gray-600 space-y-1"
                    }, [
                      React.createElement('li', { key: 'ozon-revenue' }, `• Выручка: ${formatCurrency(data[data.length-1]?.ozon.revenue || 0)}`),
                      React.createElement('li', { key: 'ozon-profit' }, `• Валовая прибыль: ${formatCurrency(data[data.length-1]?.ozon.profit || 0)}`),
                      React.createElement('li', { key: 'ozon-margin' }, `• Наценка: ${formatPercent(data[data.length-1]?.ozon.margin || 0)}`)
                    ])
                  ])
                ])
              ])
            ])
          );
        };

        // Рендер приложения
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(SalesDashboard));
    </script>
</body>
</html>
