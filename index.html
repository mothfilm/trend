<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º</title>
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="p-6 bg-gray-50 min-h-screen">
        <div class="max-w-7xl mx-auto">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">
                    –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º
                </h1>
                <p class="text-gray-600">
                    –¢—Ä–µ–Ω–¥—ã –í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ vs –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω) ‚Ä¢ —Å–µ–Ω—Ç—è–±—Ä—å 2024 - –∏—é–ª—å 2025
                </p>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ 1: –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂–∏ -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üìà –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂–∏ (RUB)
                </h2>
                <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ 2: –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üí∞ –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (RUB)
                </h2>
                <div class="chart-container">
                    <canvas id="costChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ 3: –†–∞—Å—Ö–æ–¥—ã –ú–ü -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üìä –†–∞—Å—Ö–æ–¥—ã –ú–ü (RUB)
                </h2>
                <div class="chart-container">
                    <canvas id="expensesChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ 4: –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üíµ –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å (RUB)
                </h2>
                <div class="chart-container">
                    <canvas id="profitChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ 5: –ù–∞—Ü–µ–Ω–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞) -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üìã –ù–∞—Ü–µ–Ω–∫–∞ (%) = –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å / –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å
                </h2>
                <div class="chart-container">
                    <canvas id="marginChart"></canvas>
                </div>
            </div>

            <!-- –ì—Ä–∞—Ñ–∏–∫ 6: –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üíπ –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å (%) = –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å / –í—ã—Ä—É—á–∫–∞
                </h2>
                <div class="chart-container">
                    <canvas id="profitabilityChart"></canvas>
                </div>
            </div>

            <!-- –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">
                    üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞ 11 –º–µ—Å—è—Ü–µ–≤ (—Å–µ–Ω—Ç—è–±—Ä—å 2024 - –∏—é–ª—å 2025)
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="border-l-4 border-red-500 pl-4">
                        <h3 class="font-semibold text-red-600 mb-2">–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑</h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li id="wb-total-revenue">‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: Loading...</li>
                            <li id="wb-total-profit">‚Ä¢ –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: Loading...</li>
                            <li id="wb-avg-revenue">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: Loading...</li>
                            <li id="wb-avg-profit">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: Loading...</li>
                            <li id="wb-avg-margin">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –Ω–∞—Ü–µ–Ω–∫–∞: Loading...</li>
                            <li id="wb-avg-profitability">‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: Loading...</li>
                            <li id="wb-monthly-growth">‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –º/–º: Loading...</li>
                            <li id="wb-trend">‚Ä¢ –¢—Ä–µ–Ω–¥: Loading...</li>
                        </ul>
                    </div>
                    <div class="border-l-4 border-purple-500 pl-4">
                        <h3 class="font-semibold text-purple-600 mb-2">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)</h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li id="ozon-total-revenue">‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: Loading...</li>
                            <li id="ozon-total-profit">‚Ä¢ –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: Loading...</li>
                            <li id="ozon-avg-revenue">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: Loading...</li>
                            <li id="ozon-avg-profit">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: Loading...</li>
                            <li id="ozon-avg-margin">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –Ω–∞—Ü–µ–Ω–∫–∞: Loading...</li>
                            <li id="ozon-avg-profitability">‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: Loading...</li>
                            <li id="ozon-monthly-growth">‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –º/–º: Loading...</li>
                            <li id="ozon-trend">‚Ä¢ –¢—Ä–µ–Ω–¥: Loading...</li>
                        </ul>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-green-600 mb-2">–û–±—â–∏–π –∏—Ç–æ–≥</h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li id="total-total-revenue">‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: Loading...</li>
                            <li id="total-total-profit">‚Ä¢ –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: Loading...</li>
                            <li id="total-avg-revenue">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: Loading...</li>
                            <li id="total-avg-profit">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: Loading...</li>
                            <li id="total-avg-margin">‚Ä¢ –°—Ä–µ–¥–Ω—è—è –Ω–∞—Ü–µ–Ω–∫–∞: Loading...</li>
                            <li id="total-avg-profitability">‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: Loading...</li>
                            <li id="total-monthly-growth">‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –º/–º: Loading...</li>
                            <li id="total-trend">‚Ä¢ –¢—Ä–µ–Ω–¥: Loading...</li>
                        </ul>
                    </div>
                </div>
                
                <!-- –õ—É—á—à–∏–µ –∏ —Ö—É–¥—à–∏–µ –º–µ—Å—è—Ü—ã -->
                <div class="mt-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">üèÜ –õ—É—á—à–∏–µ –∏ —Ö—É–¥—à–∏–µ –º–µ—Å—è—Ü—ã</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-green-50 rounded-lg p-4">
                            <h4 class="font-semibold text-green-800 mb-3">ü•á –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h4>
                            <div class="space-y-2 text-sm">
                                <div id="best-revenue-month" class="text-green-700"></div>
                                <div id="best-profit-month" class="text-green-700"></div>
                                <div id="best-margin-month" class="text-green-700"></div>
                            </div>
                        </div>
                        <div class="bg-red-50 rounded-lg p-4">
                            <h4 class="font-semibold text-red-800 mb-3">üìâ –¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</h4>
                            <div class="space-y-2 text-sm">
                                <div id="worst-revenue-month" class="text-red-700"></div>
                                <div id="worst-profit-month" class="text-red-700"></div>
                                <div id="worst-margin-month" class="text-red-700"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–∑ Excel —Ñ–∞–π–ª–æ–≤ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
        const rawData = {
            months: [
                "—Å–µ–Ω—Ç—è–±—Ä—å 2024", "–æ–∫—Ç—è–±—Ä—å 2024", "–Ω–æ—è–±—Ä—å 2024", "–î–µ–∫–∞–±—Ä—å 2024",
                "–Ø–µ–≤–∞—Ä—å 2025", "—Ñ–µ–≤—Ä–∞–ª—å 2025", "–º–∞—Ä—Ç 2025", "–ê–ø—Ä–µ–ª—å 2025",
                "–º–∞–π 2025", "–∏—é–Ω—å 2025", "–∏—é–ª—å 2025"
            ],
            wildberries: {
                revenue: [5061499.6, 3631804.04, 4296754, 5008242, 2196432.59, 4025213, 6175693, 5674564.96, 5284511.76, 6649356, 3933461.14],
                cost: [2606218.37, 1765480, 2256487, 2624292, 1078915.61, 2124256, 3507219, 3422528.94, 2974300.92, 3941421, 1934417.68],
                expenses: [818363.28, 693959, 820414, 849207, 475453, 503020, 770128, 1049231.95, 1024672.00, 1380637, 1595713.83],
                profit: [1636917.95, 1172365.04, 1219853, 1534743, 642063.98, 1397937, 1898346, 1202804.07, 1285538.84, 1327298, 403329.63]
            },
            ozon: {
                revenue: [9478101.03, 11106722.23, 12948704, 15579920, 14399817.7, 13388232, 16858885, 12986901.1, 15676967.84, 12416880, 15245155.22],
                cost: [4793858.65, 5750748, 6436076, 7560970, 6937700.83, 6903617, 9297120, 7117001.02, 8272715.16, 7510481, 8831417.36],
                expenses: [3027975.14, 2867115, 4162147, 5314721, 4404780, 3504031, 3505049, 2962843.3, 3488338.00, 1965388, 3674050.1],
                profit: [1656267.24, 2488859.23, 2350481, 2704229, 3057336.87, 2980584, 4056716, 2907056.78, 3915914.68, 2941011, 2739687.76]
            }
        };

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
        function calculateMetrics(data) {
            const calculated = JSON.parse(JSON.stringify(data)); // –≥–ª—É–±–æ–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
            
            // –†–∞—Å—á–µ—Ç –Ω–∞—Ü–µ–Ω–∫–∏ = –≤–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å / —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å * 100
            calculated.wildberries.margin = calculated.wildberries.profit.map((profit, i) => 
                (profit / calculated.wildberries.cost[i]) * 100
            );
            calculated.ozon.margin = calculated.ozon.profit.map((profit, i) => 
                (profit / calculated.ozon.cost[i]) * 100
            );
            
            // –†–∞—Å—á–µ—Ç —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ = –≤–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å / –≤—ã—Ä—É—á–∫–∞ * 100
            calculated.wildberries.profitability = calculated.wildberries.profit.map((profit, i) => 
                (profit / calculated.wildberries.revenue[i]) * 100
            );
            calculated.ozon.profitability = calculated.ozon.profit.map((profit, i) => 
                (profit / calculated.ozon.revenue[i]) * 100
            );
            
            return calculated;
        }

        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏
        const data = calculateMetrics(rawData);

        // –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function updateEfficiencyAnalysis() {
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—É–º–º—ã
            function sum(arr) {
                return arr.reduce((a, b) => a + b, 0);
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
            function average(arr) {
                return arr.reduce((a, b) => a + b, 0) / arr.length;
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Å—è—á–Ω–æ–≥–æ —Ç–µ–º–ø–∞ —Ä–æ—Å—Ç–∞
            function calculateMonthlyGrowthRate(arr) {
                let growthRates = [];
                for (let i = 1; i < arr.length; i++) {
                    if (arr[i-1] > 0 && arr[i] > 0) {
                        growthRates.push((arr[i] - arr[i-1]) / arr[i-1] * 100);
                    }
                }
                return growthRates.length > 0 ? average(growthRates) : 0;
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞
            function getTrend(arr) {
                const firstHalf = average(arr.slice(0, Math.floor(arr.length/2)));
                const secondHalf = average(arr.slice(Math.floor(arr.length/2)));
                const change = ((secondHalf - firstHalf) / firstHalf) * 100;
                
                if (change > 5) return "üìà –†–∞—Å—Ç–µ—Ç";
                if (change < -5) return "üìâ –ü–∞–¥–∞–µ—Ç";
                return "üìä –°—Ç–∞–±–∏–ª—å–Ω–æ";
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª—É—á—à–µ–≥–æ/—Ö—É–¥—à–µ–≥–æ –º–µ—Å—è—Ü–∞
            function findBestWorst(arr, type = 'max') {
                const index = type === 'max' ? 
                    arr.indexOf(Math.max(...arr)) : 
                    arr.indexOf(Math.min(...arr));
                return { index, value: arr[index], month: data.months[index] };
            }

            // –†–∞—Å—á–µ—Ç—ã –¥–ª—è –í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑
            const wbTotalRevenue = sum(data.wildberries.revenue);
            const wbTotalProfit = sum(data.wildberries.profit);
            const wbAvgRevenue = average(data.wildberries.revenue);
            const wbAvgProfit = average(data.wildberries.profit);
            const wbAvgMargin = average(data.wildberries.margin);
            const wbAvgProfitability = average(data.wildberries.profitability);
            const wbMonthlyGrowth = calculateMonthlyGrowthRate(data.wildberries.revenue);
            const wbTrend = getTrend(data.wildberries.revenue);
            
            // –†–∞—Å—á–µ—Ç—ã –¥–ª—è –û–∑–æ–Ω
            const ozonTotalRevenue = sum(data.ozon.revenue);
            const ozonTotalProfit = sum(data.ozon.profit);
            const ozonAvgRevenue = average(data.ozon.revenue);
            const ozonAvgProfit = average(data.ozon.profit);
            const ozonAvgMargin = average(data.ozon.margin);
            const ozonAvgProfitability = average(data.ozon.profitability);
            const ozonMonthlyGrowth = calculateMonthlyGrowthRate(data.ozon.revenue);
            const ozonTrend = getTrend(data.ozon.revenue);
            
            // –†–∞—Å—á–µ—Ç—ã –¥–ª—è –æ–±—â–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            const totalRevenue = data.wildberries.revenue.map((wb, i) => wb + data.ozon.revenue[i]);
            const totalProfit = data.wildberries.profit.map((wb, i) => wb + data.ozon.profit[i]);
            const totalCost = data.wildberries.cost.map((wb, i) => wb + data.ozon.cost[i]);
            const totalMargin = totalProfit.map((profit, i) => (profit / totalCost[i]) * 100);
            const totalProfitability = totalProfit.map((profit, i) => (profit / totalRevenue[i]) * 100);
            
            const totalTotalRevenue = sum(totalRevenue);
            const totalTotalProfit = sum(totalProfit);
            const totalAvgRevenue = average(totalRevenue);
            const totalAvgProfit = average(totalProfit);
            const totalAvgMargin = average(totalMargin);
            const totalAvgProfitability = average(totalProfitability);
            const totalMonthlyGrowth = calculateMonthlyGrowthRate(totalRevenue);
            const totalTrend = getTrend(totalRevenue);

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑
            document.getElementById('wb-total-revenue').innerHTML = `‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: <span class="font-semibold text-red-700">${formatCurrency(wbTotalRevenue)}</span>`;
            document.getElementById('wb-total-profit').innerHTML = `‚Ä¢ –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: <span class="font-semibold text-red-700">${formatCurrency(wbTotalProfit)}</span>`;
            document.getElementById('wb-avg-revenue').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: ${formatCurrency(wbAvgRevenue)}`;
            document.getElementById('wb-avg-profit').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: ${formatCurrency(wbAvgProfit)}`;
            document.getElementById('wb-avg-margin').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –Ω–∞—Ü–µ–Ω–∫–∞: ${wbAvgMargin.toFixed(1)}%`;
            document.getElementById('wb-avg-profitability').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: ${wbAvgProfitability.toFixed(1)}%`;
            document.getElementById('wb-monthly-growth').innerHTML = `‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –º/–º: <span class="${wbMonthlyGrowth >= 0 ? 'text-green-600' : 'text-red-600'}">${wbMonthlyGrowth >= 0 ? '+' : ''}${wbMonthlyGrowth.toFixed(1)}%</span>`;
            document.getElementById('wb-trend').textContent = `‚Ä¢ –¢—Ä–µ–Ω–¥: ${wbTrend}`;

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –û–∑–æ–Ω
            document.getElementById('ozon-total-revenue').innerHTML = `‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: <span class="font-semibold text-purple-700">${formatCurrency(ozonTotalRevenue)}</span>`;
            document.getElementById('ozon-total-profit').innerHTML = `‚Ä¢ –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: <span class="font-semibold text-purple-700">${formatCurrency(ozonTotalProfit)}</span>`;
            document.getElementById('ozon-avg-revenue').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: ${formatCurrency(ozonAvgRevenue)}`;
            document.getElementById('ozon-avg-profit').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: ${formatCurrency(ozonAvgProfit)}`;
            document.getElementById('ozon-avg-margin').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –Ω–∞—Ü–µ–Ω–∫–∞: ${ozonAvgMargin.toFixed(1)}%`;
            document.getElementById('ozon-avg-profitability').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: ${ozonAvgProfitability.toFixed(1)}%`;
            document.getElementById('ozon-monthly-growth').innerHTML = `‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –º/–º: <span class="${ozonMonthlyGrowth >= 0 ? 'text-green-600' : 'text-red-600'}">${ozonMonthlyGrowth >= 0 ? '+' : ''}${ozonMonthlyGrowth.toFixed(1)}%</span>`;
            document.getElementById('ozon-trend').textContent = `‚Ä¢ –¢—Ä–µ–Ω–¥: ${ozonTrend}`;

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
            document.getElementById('total-total-revenue').innerHTML = `‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: <span class="font-bold text-green-800">${formatCurrency(totalTotalRevenue)}</span>`;
            document.getElementById('total-total-profit').innerHTML = `‚Ä¢ –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å: <span class="font-bold text-green-800">${formatCurrency(totalTotalProfit)}</span>`;
            document.getElementById('total-avg-revenue').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: ${formatCurrency(totalAvgRevenue)}`;
            document.getElementById('total-avg-profit').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –ø—Ä–∏–±—ã–ª—å: ${formatCurrency(totalAvgProfit)}`;
            document.getElementById('total-avg-margin').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è –Ω–∞—Ü–µ–Ω–∫–∞: ${totalAvgMargin.toFixed(1)}%`;
            document.getElementById('total-avg-profitability').textContent = `‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: ${totalAvgProfitability.toFixed(1)}%`;
            document.getElementById('total-monthly-growth').innerHTML = `‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –º/–º: <span class="${totalMonthlyGrowth >= 0 ? 'text-green-600' : 'text-red-600'}">${totalMonthlyGrowth >= 0 ? '+' : ''}${totalMonthlyGrowth.toFixed(1)}%</span>`;
            document.getElementById('total-trend').textContent = `‚Ä¢ –¢—Ä–µ–Ω–¥: ${totalTrend}`;

            // –õ—É—á—à–∏–µ –∏ —Ö—É–¥—à–∏–µ –º–µ—Å—è—Ü—ã
            const bestRevenue = findBestWorst(totalRevenue, 'max');
            const worstRevenue = findBestWorst(totalRevenue, 'min');
            const bestProfit = findBestWorst(totalProfit, 'max');
            const worstProfit = findBestWorst(totalProfit, 'min');
            const bestMargin = findBestWorst(totalMargin, 'max');
            const worstMargin = findBestWorst(totalMargin, 'min');

            document.getElementById('best-revenue-month').textContent = `üí∞ –õ—É—á—à–∞—è –≤—ã—Ä—É—á–∫–∞: ${bestRevenue.month} (${formatCurrency(bestRevenue.value)})`;
            document.getElementById('best-profit-month').textContent = `üíé –õ—É—á—à–∞—è –ø—Ä–∏–±—ã–ª—å: ${bestProfit.month} (${formatCurrency(bestProfit.value)})`;
            document.getElementById('best-margin-month').textContent = `üìà –õ—É—á—à–∞—è –Ω–∞—Ü–µ–Ω–∫–∞: ${bestMargin.month} (${bestMargin.value.toFixed(1)}%)`;

            document.getElementById('worst-revenue-month').textContent = `üí∏ –ù–∏–∑–∫–∞—è –≤—ã—Ä—É—á–∫–∞: ${worstRevenue.month} (${formatCurrency(worstRevenue.value)})`;
            document.getElementById('worst-profit-month').textContent = `üìâ –ù–∏–∑–∫–∞—è –ø—Ä–∏–±—ã–ª—å: ${worstProfit.month} (${formatCurrency(worstProfit.value)})`;
            document.getElementById('worst-margin-month').textContent = `üìä –ù–∏–∑–∫–∞—è –Ω–∞—Ü–µ–Ω–∫–∞: ${worstMargin.month} (${worstMargin.value.toFixed(1)}%)`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∞–ª—é—Ç—ã
        function formatCurrency(value) {
            if (value >= 1000000) {
                return (value / 1000000).toFixed(1) + '–ú ‚ÇΩ';
            }
            if (value >= 1000) {
                return (value / 1000).toFixed(0) + '–ö ‚ÇΩ';
            }
            return value.toFixed(0) + ' ‚ÇΩ';
        }

        // –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                },
                tooltip: {
                    mode: 'index',
                    intersect: false,
                }
            },
            scales: {
                x: {
                    display: true,
                    ticks: {
                        maxRotation: 45,
                        minRotation: 45
                    }
                },
                y: {
                    display: true,
                    beginAtZero: true
                }
            }
        };

        // –ì—Ä–∞—Ñ–∏–∫ 1: –í—ã—Ä—É—á–∫–∞
        const revenueCtx = document.getElementById('revenueChart').getContext('2d');
        new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: data.months,
                datasets: [{
                    label: '–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑',
                    data: data.wildberries.revenue,
                    borderColor: '#dc2626',
                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#dc2626',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)',
                    data: data.ozon.revenue,
                    borderColor: '#7c3aed',
                    backgroundColor: 'rgba(124, 58, 237, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#7c3aed',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            callback: function(value) {
                                return formatCurrency(value);
                            }
                        }
                    }
                }
            }
        });

        // –†–∞—Å—á–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏—Ä–æ—Å—Ç–∞ —Å —Å–µ–Ω—Ç—è–±—Ä—è 2024
        function calculateAndDisplayGrowth() {
            const baseMonth = 0; // –∏–Ω–¥–µ–∫—Å —Å–µ–Ω—Ç—è–±—Ä—è 2024
            const lastMonth = data.months.length - 1; // –∏–Ω–¥–µ–∫—Å –∏—é–ª—è 2025
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏—Ä–æ—Å—Ç–∞
            function calculateGrowth(currentValue, baseValue) {
                return ((currentValue - baseValue) / baseValue) * 100;
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Å —Ü–≤–µ—Ç–æ–º
            function formatGrowthPercent(growth) {
                const isPositive = growth >= 0;
                const color = isPositive ? 'text-green-600' : 'text-red-600';
                const sign = isPositive ? '+' : '';
                return `<span class="${color}">${sign}${growth.toFixed(1)}%</span>`;
            }

            // –†–∞—Å—á–µ—Ç –ø—Ä–∏—Ä–æ—Å—Ç–∞ –¥–ª—è –í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑
            const wbRevenueGrowth = calculateGrowth(
                data.wildberries.revenue[lastMonth], 
                data.wildberries.revenue[baseMonth]
            );
            const wbProfitGrowth = calculateGrowth(
                data.wildberries.profit[lastMonth], 
                data.wildberries.profit[baseMonth]
            );
            const wbMarginGrowth = calculateGrowth(
                data.wildberries.margin[lastMonth], 
                data.wildberries.margin[baseMonth]
            );
            const wbProfitabilityGrowth = calculateGrowth(
                data.wildberries.profitability[lastMonth], 
                data.wildberries.profitability[baseMonth]
            );

            // –†–∞—Å—á–µ—Ç –ø—Ä–∏—Ä–æ—Å—Ç–∞ –¥–ª—è –û–∑–æ–Ω
            const ozonRevenueGrowth = calculateGrowth(
                data.ozon.revenue[lastMonth], 
                data.ozon.revenue[baseMonth]
            );
            const ozonProfitGrowth = calculateGrowth(
                data.ozon.profit[lastMonth], 
                data.ozon.profit[baseMonth]
            );
            const ozonMarginGrowth = calculateGrowth(
                data.ozon.margin[lastMonth], 
                data.ozon.margin[baseMonth]
            );
            const ozonProfitabilityGrowth = calculateGrowth(
                data.ozon.profitability[lastMonth], 
                data.ozon.profitability[baseMonth]
            );

            // –†–∞—Å—á–µ—Ç –ø—Ä–∏—Ä–æ—Å—Ç–∞ –¥–ª—è –æ–±—â–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            const totalRevenueBase = data.wildberries.revenue[baseMonth] + data.ozon.revenue[baseMonth];
            const totalRevenueLast = data.wildberries.revenue[lastMonth] + data.ozon.revenue[lastMonth];
            const totalProfitBase = data.wildberries.profit[baseMonth] + data.ozon.profit[baseMonth];
            const totalProfitLast = data.wildberries.profit[lastMonth] + data.ozon.profit[lastMonth];
            const totalCostBase = data.wildberries.cost[baseMonth] + data.ozon.cost[baseMonth];
            const totalCostLast = data.wildberries.cost[lastMonth] + data.ozon.cost[lastMonth];
            
            const totalRevenueGrowth = calculateGrowth(totalRevenueLast, totalRevenueBase);
            const totalProfitGrowth = calculateGrowth(totalProfitLast, totalProfitBase);
            const totalMarginBase = (totalProfitBase / totalCostBase) * 100;
            const totalMarginLast = (totalProfitLast / totalCostLast) * 100;
            const totalMarginGrowth = calculateGrowth(totalMarginLast, totalMarginBase);
            const totalProfitabilityBase = (totalProfitBase / totalRevenueBase) * 100;
            const totalProfitabilityLast = (totalProfitLast / totalRevenueLast) * 100;
            const totalProfitabilityGrowth = calculateGrowth(totalProfitabilityLast, totalProfitabilityBase);

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
            document.getElementById('wb-revenue-growth').innerHTML = formatGrowthPercent(wbRevenueGrowth);
            document.getElementById('wb-profit-growth').innerHTML = formatGrowthPercent(wbProfitGrowth);
            document.getElementById('wb-margin-growth').innerHTML = formatGrowthPercent(wbMarginGrowth);
            document.getElementById('wb-profitability-growth').innerHTML = formatGrowthPercent(wbProfitabilityGrowth);
            
            document.getElementById('ozon-revenue-growth').innerHTML = formatGrowthPercent(ozonRevenueGrowth);
            document.getElementById('ozon-profit-growth').innerHTML = formatGrowthPercent(ozonProfitGrowth);
            document.getElementById('ozon-margin-growth').innerHTML = formatGrowthPercent(ozonMarginGrowth);
            document.getElementById('ozon-profitability-growth').innerHTML = formatGrowthPercent(ozonProfitabilityGrowth);

            document.getElementById('total-revenue-growth').innerHTML = formatGrowthPercent(totalRevenueGrowth);
            document.getElementById('total-profit-growth').innerHTML = formatGrowthPercent(totalProfitGrowth);
            document.getElementById('total-margin-growth').innerHTML = formatGrowthPercent(totalMarginGrowth);
            document.getElementById('total-profitability-growth').innerHTML = formatGrowthPercent(totalProfitabilityGrowth);

            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—Ä–æ—Å—Ç–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
            const tableBody = document.getElementById('growth-table');
            for (let i = 0; i < data.months.length; i++) {
                const wbGrowth = i === 0 ? 0 : calculateGrowth(data.wildberries.revenue[i], data.wildberries.revenue[baseMonth]);
                const ozonGrowth = i === 0 ? 0 : calculateGrowth(data.ozon.revenue[i], data.ozon.revenue[baseMonth]);
                const totalRevenueCurrent = data.wildberries.revenue[i] + data.ozon.revenue[i];
                const totalGrowth = i === 0 ? 0 : calculateGrowth(totalRevenueCurrent, totalRevenueBase);
                
                const row = document.createElement('tr');
                row.className = i % 2 === 0 ? 'bg-gray-50' : 'bg-white';
                row.innerHTML = `
                    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${data.months[i]}</td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm">${formatGrowthPercent(wbGrowth)}</td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm">${formatGrowthPercent(ozonGrowth)}</td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm">${formatGrowthPercent(totalGrowth)}</td>
                `;
                tableBody.appendChild(row);
            }
        }

        // –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
        updateEfficiencyAnalysis();

        // –ì—Ä–∞—Ñ–∏–∫ 2: –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å
        const costCtx = document.getElementById('costChart').getContext('2d');
        new Chart(costCtx, {
            type: 'line',
            data: {
                labels: data.months,
                datasets: [{
                    label: '–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑',
                    data: data.wildberries.cost,
                    borderColor: '#dc2626',
                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#dc2626',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)',
                    data: data.ozon.cost,
                    borderColor: '#7c3aed',
                    backgroundColor: 'rgba(124, 58, 237, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#7c3aed',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            callback: function(value) {
                                return formatCurrency(value);
                            }
                        }
                    }
                }
            }
        });

        // –ì—Ä–∞—Ñ–∏–∫ 3: –†–∞—Å—Ö–æ–¥—ã –ú–ü
        const expensesCtx = document.getElementById('expensesChart').getContext('2d');
        new Chart(expensesCtx, {
            type: 'line',
            data: {
                labels: data.months,
                datasets: [{
                    label: '–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑',
                    data: data.wildberries.expenses,
                    borderColor: '#dc2626',
                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#dc2626',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)',
                    data: data.ozon.expenses,
                    borderColor: '#7c3aed',
                    backgroundColor: 'rgba(124, 58, 237, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#7c3aed',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            callback: function(value) {
                                return formatCurrency(value);
                            }
                        }
                    }
                }
            }
        });

        // –ì—Ä–∞—Ñ–∏–∫ 4: –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å
        const profitCtx = document.getElementById('profitChart').getContext('2d');
        new Chart(profitCtx, {
            type: 'line',
            data: {
                labels: data.months,
                datasets: [{
                    label: '–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑',
                    data: data.wildberries.profit,
                    borderColor: '#dc2626',
                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#dc2626',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)',
                    data: data.ozon.profit,
                    borderColor: '#7c3aed',
                    backgroundColor: 'rgba(124, 58, 237, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#7c3aed',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            callback: function(value) {
                                return formatCurrency(value);
                            }
                        }
                    }
                }
            }
        });

        // –ì—Ä–∞—Ñ–∏–∫ 5: –ù–∞—Ü–µ–Ω–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞)
        const marginCtx = document.getElementById('marginChart').getContext('2d');
        new Chart(marginCtx, {
            type: 'line',
            data: {
                labels: data.months,
                datasets: [{
                    label: '–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑',
                    data: data.wildberries.margin,
                    borderColor: '#dc2626',
                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#dc2626',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)',
                    data: data.ozon.margin,
                    borderColor: '#7c3aed',
                    backgroundColor: 'rgba(124, 58, 237, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#7c3aed',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            callback: function(value) {
                                return value.toFixed(1) + '%';
                            }
                        }
                    }
                }
            }
        });

        // –ì—Ä–∞—Ñ–∏–∫ 6: –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
        const profitabilityCtx = document.getElementById('profitabilityChart').getContext('2d');
        new Chart(profitabilityCtx, {
            type: 'line',
            data: {
                labels: data.months,
                datasets: [{
                    label: '–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑',
                    data: data.wildberries.profitability,
                    borderColor: '#dc2626',
                    backgroundColor: 'rgba(220, 38, 38, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#dc2626',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }, {
                    label: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –†–µ—à–µ–Ω–∏—è –û–û–û (–û–∑–æ–Ω)',
                    data: data.ozon.profitability,
                    borderColor: '#7c3aed',
                    backgroundColor: 'rgba(124, 58, 237, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#7c3aed',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    ...chartOptions.scales,
                    y: {
                        ...chartOptions.scales.y,
                        ticks: {
                            callback: function(value) {
                                return value.toFixed(1) + '%';
                            }
                        }
                    }
                }
            }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å–≤–æ–¥–∫–µ
        function updateSummaryDisplay() {
            const lastIndex = data.months.length - 1;
            
            // –î–∞–Ω–Ω—ã–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
            document.getElementById('wb-margin-display').textContent = 
                `‚Ä¢ –ù–∞—Ü–µ–Ω–∫–∞: ${data.wildberries.margin[lastIndex].toFixed(1)}%`;
            document.getElementById('wb-profitability-display').textContent = 
                `‚Ä¢ –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: ${data.wildberries.profitability[lastIndex].toFixed(1)}%`;
                
            document.getElementById('ozon-margin-display').textContent = 
                `‚Ä¢ –ù–∞—Ü–µ–Ω–∫–∞: ${data.ozon.margin[lastIndex].toFixed(1)}%`;
            document.getElementById('ozon-profitability-display').textContent = 
                `‚Ä¢ –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: ${data.ozon.profitability[lastIndex].toFixed(1)}%`;
                
            // –†–∞—Å—á–µ—Ç –æ–±—â–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            const totalRevenue = data.wildberries.revenue[lastIndex] + data.ozon.revenue[lastIndex];
            const totalCost = data.wildberries.cost[lastIndex] + data.ozon.cost[lastIndex];
            const totalProfit = data.wildberries.profit[lastIndex] + data.ozon.profit[lastIndex];
            const totalMargin = (totalProfit / totalCost) * 100;
            const totalProfitability = (totalProfit / totalRevenue) * 100;
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            document.getElementById('total-revenue-display').textContent = 
                `‚Ä¢ –í—ã—Ä—É—á–∫–∞: ${formatCurrency(totalRevenue)}`;
            document.getElementById('total-profit-display').textContent = 
                `‚Ä¢ –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å: ${formatCurrency(totalProfit)}`;
            document.getElementById('total-margin-display').textContent = 
                `‚Ä¢ –ù–∞—Ü–µ–Ω–∫–∞: ${totalMargin.toFixed(1)}%`;
            document.getElementById('total-profitability-display').textContent = 
                `‚Ä¢ –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: ${totalProfitability.toFixed(1)}%`;
        }
    </script>
</body>
</html>
